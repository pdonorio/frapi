# Create my cluster. Syntax: http://www.fig.sh/yml.html

# Simple fs share
fs:
    image: busybox
    volumes:
        - ./tmp:/opt/fsshare
# Empty container which holds the data directory
data:
    build: ./docker/pybase
    volumes:
        - ./data:/data:rw

# Database server
rdb:
    build: ./docker/rethinkdb
    volumes_from:
         - data # Import data directory from storage container
         - fs

#Â Python api server connected to Rethink DB database
web:
    build: ./docker/webapp
    volumes:
    - ./app:/opt/app
    working_dir: /opt/app
    volumes_from:
         - fs
    #command: python -B app/main.py
    links:
    - rdb:db
    ports:
    - "5005:5000" # Only if access from outside :)

# OTHER USEFULL OPTIONS
# mem_limit: 1000000000
# privileged: true
# environment:
#   KEYDBPASS:
